https://juejin.cn/post/6844903565610188807#comment

https://juejin.cn/post/7004465786425180197



##### 1、渲染的过程如下图：

![](https://gitee.com/JuntengMa/imgae/raw/master/202202171639329.webp)

##### 2、浏览器的渲染过程主要包括以下几步：

1. 解析HTML生成DOM树。
2. 解析CSS生成CSSOM规则树。
3. 将DOM树与CSSOM规则树合并在一起生成渲染树(Render Tree)。
4. 遍历渲染树开始布局，计算每个节点的位置大小信息 ( 回流 )。
5. 将渲染树每个节点绘制到屏幕。

##### 3、构建DOM树

当浏览器接收到服务器响应来的HTML文档后，会遍历文档节点，生成DOM树。

需要注意的是，`DOM树的生成过程中可能会被CSS和JS的加载执行阻塞。渲染阻塞问题下文会讲。`

##### 5、渲染阻塞

> 当浏览器遇到一个 `script `标记时，DOM 构建将`暂停`，直至脚本完成执行，然后继续构建DOM。
>
> 每次去`加载和执行`JavaScript脚本都会`严重地阻塞DOM树的构建`;
>
> 如果JavaScript脚本还操作了CSSOM，而正好这个CSSOM还没有下载和构建，浏览器甚至会延迟脚本执行和构建DOM，直至完成其CSSOM的下载和构建。
>
> 所以，script 标签的位置很重要。实际使用时，可以遵循下面两个原则：
>
> - CSS 优先：引入顺序上，CSS 资源先于 JavaScript 资源。
> - JS置后：我们通常把JS代码放到页面底部，且JavaScript 应尽量少影响 DOM 的构建。
>
> 当解析html的时候，会把新来的元素插入dom树里面，同时去查找css，然后把对应的样式规则应用到元素上，查找样式表是按照从右到左的顺序去匹配的。
>
> 例如： div p {font-size: 16px}，会先寻找所有p标签并判断它的父标签是否为div之后才会决定要不要采用这个样式进行渲染）。
> 所以，我们平时写CSS时，尽量用id和class，千万不要过渡层叠。

#### 一些需要注意的问题：

> 浏览器获取的 html 资源后==自上而下==开始解析，生成 dom 树；
>
> 如果遇到 style 的内联样式和 link 会将 css 交由 css 渲染器构建 css 规则树； 
>
> 其中加载 link 引入的外部样式文件是`异步加载`的，并且`整个 css 规则树也是与 dom 树的构建是并行`的；

2、CSS加载会不会影响DOM解析？会不会影响DOM树渲染？

> https://segmentfault.com/a/1190000018130499  
> 结论： 不会影响DOM解析，但是会影响DOM渲染
>
> - DOM树解析 和 CSS解析 是异步的，互不阻塞
> - Render Tree 需要 DOM树+Css规则树 ，故css加载未完成之前，页面无法正常渲染

3、JS执行会造成Dom构建吗？

> - 当浏览器遇到一个 `script `标记时，DOM 构建将`暂停`，直至脚本完成执行，然后继续构建DOM。
>
> - 如果JavaScript脚本还操作了CSSOM，而正好这个CSSOM还没有下载和构建，浏览器甚至会延迟脚本执行和构建DOM，直至完成其CSSOM的下载和构建。

4、html与js是否是并行下载

> 答：不是
>
> html下载构建dom后读取到外联js tag才会下载

5、是js的下载阻塞了页面的渲染还是js的执行阻塞了页面的渲染，还是两者都会阻塞页面

> 答：两者都会（js的下载和执行都会阻塞页面渲染）
> DOM 树解析到非异步的外联 js 时会阻塞住，在它加载并且执行完之前，不会往下解析 DOM 树。

3，script标签放在head中与放在body中，是影响了js的下载开始时间还是执行开始时间

> 如果不考虑 http 并发请求数的限制，并且忽略掉接收页面 response body 的耗时的话，在有预解析的浏览器上，外联的 script 放哪都不会（太）影响加载开始时间。
>
> 需要注意的是，虽然加载是并行化的，但 js 会阻塞住 dom 树解析，因而你把 script[src]放在 head 中会阻塞住首屏渲染，最好还是放在 body 尾部。

4，css，图片以及一些其它的外部资源的下载是否与html，js的下载并行

> 除了 CSS 和 JS，其他外部资源都会并行